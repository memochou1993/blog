---
title: 使用 Go 調整圖片大小
date: 2021-08-03 14:25:07
tags: ["程式設計", "Go"]
categories: ["程式設計", "Go", "其他"]
---

## 做法

### 使用 draw 套件

下載 `draw` 套件。

```bash
go get golang.org/x/image/draw
```

#### PNG

新增 `main.go` 檔：

```go
package main

import (
	"image"
	"image/png"
	"log"
	"os"

	"golang.org/x/image/draw"
)

func main() {
	// 輸入圖檔
	input, _ := os.Open("example.png")
	defer input.Close()

	// 解碼
	src, err := png.Decode(input)
	if err != nil {
		log.Fatal(err.Error())
	}

	// 輸出圖檔
	output, _ := os.Create("example_resized.png")
	defer output.Close()

	// 將高和寬設為原來的二分之一
	dst := image.NewRGBA(image.Rect(0, 0, src.Bounds().Max.X/2, src.Bounds().Max.Y/2))
	draw.NearestNeighbor.Scale(dst, dst.Rect, src, src.Bounds(), draw.Over, nil)

	// 編碼
	if err = png.Encode(output, dst); err != nil {
		log.Fatal(err)
	}
}
```

執行。

```bash
go run main.go
```

#### JPEG

新增 `main.go` 檔：

```go
package main

import (
	"image"
	"image/jpeg"
	"log"
	"os"

	"golang.org/x/image/draw"
)

func main() {
	// 輸入圖檔
	input, _ := os.Open("example.jpeg")
	defer input.Close()

	// 解碼
	src, err := jpeg.Decode(input)
	if err != nil {
		log.Fatal(err.Error())
	}

	// 輸出圖檔
	output, _ := os.Create("example_resized.jpeg")
	defer output.Close()

	// 將高和寬設為原來的二分之一
	dst := image.NewRGBA(image.Rect(0, 0, src.Bounds().Max.X/2, src.Bounds().Max.Y/2))
	draw.NearestNeighbor.Scale(dst, dst.Rect, src, src.Bounds(), draw.Over, nil)

	// 編碼
	if err = jpeg.Encode(output, dst, &jpeg.Options{Quality: 100}); err != nil {
		log.Fatal(err)
	}
}
```

執行。

```bash
go run main.go
```

可使用的演算法有：

- NearestNeighbor
- ApproxBiLinear
- BiLinear
- CatmullRom

### 使用 imaging 套件

下載 `imaging` 套件。

```bash
go get -u github.com/disintegration/imaging
```

新增 `main.go` 檔：

```go
package main

import (
	"image/png"
	"log"
	"os"

	"github.com/disintegration/imaging"
)

func main() {
	// 輸入圖檔
	input, _ := os.Open("example.png")
	defer input.Close()

	// 解碼
	src, err := png.Decode(input)
	if err != nil {
		log.Fatal(err.Error())
	}

	// 輸出圖檔
	output, _ := os.Create("example_resized.png")
	defer output.Close()

	// 將高和寬設為原來的二分之一
	dst := imaging.Resize(src, src.Bounds().Max.X/2, src.Bounds().Max.Y/2, imaging.Lanczos)

	// 編碼
	if err = png.Encode(output, dst); err != nil {
		log.Fatal(err)
	}
}
```

執行。

```bash
go run main.go
```

可使用的演算法有：

- Lanczos
- CatmullRom
- MitchellNetravali
- Linear
- Box
- NearestNeighbor
