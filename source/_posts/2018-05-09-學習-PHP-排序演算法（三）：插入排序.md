---
title: 學習 PHP 排序演算法（三）：插入排序
date: 2018-05-09 10:20:53
tags: ["程式寫作", "PHP", "排序演算法"]
---

## 作法
把未排序的元素，在已排序的陣列裡頭，從後向前比對，找到相應的位置後插入。

## 實作
原始陣列。
```PHP
$arr = [75, 18, 53, 94, 31];
```
首先把陣列的第 2 個值 `18` 設為準備插入值。
```PHP
$i = 1;
$temp = $arr[$i];
```
先做一次比較迴圈，如果準備插入值小於比較值（準備插入值的前一個值），就把比較值複製到後面一個位置，並且停止迴圈。
```PHP
for($j = $i - 1; $j >= 0 && $temp < $arr[$j]; $j--) { 
    $arr[$j + 1] = $arr[$j];
}
```
輸出：
```PHP
Array ( [0] => 75 [1] => 75 [2] => 53 [3] => 94 [4] => 31 )
```
再把比較值的位置改為準備插入值 `18`。
```PHP
$arr[$j + 1] = $temp;
```
輸出：
```PHP
Array ( [0] => 18 [1] => 75 [2] => 53 [3] => 94 [4] => 31 )
```
這樣的判斷做 4 遍，也就是 `(n-1)` 次，就可以得到：
```PHP
// Array ( [0] => 75 [1] => 18 [2] => 53 [3] => 94 [4] => 31 )
// 準備插入値 18 比比較値 75 小，比較値 75 往後複製
// Array ( [0] => 75 [1] => 75 [2] => 53 [3] => 94 [4] => 31 )
// 比較値位置改為準備插入値 18
Array ( [0] => 18 [1] => 75 [2] => 53 [3] => 94 [4] => 31 )
// 準備插入値 53 比比較値 75 小，比較値 75 往後複製
// Array ( [0] => 18 [1] => 75 [2] => 75 [3] => 94 [4] => 31 )
// 比較値位置改為準備插入値 53
Array ( [0] => 18 [1] => 53 [2] => 75 [3] => 94 [4] => 31 )
// 準備插入値 94 沒有比比較値 75 小
Array ( [0] => 18 [1] => 53 [2] => 75 [3] => 94 [4] => 31 )
// 準備插入値 31 比比較値 94 小，比較値 94 往後複製
// Array ( [0] => 18 [1] => 53 [2] => 75 [3] => 94 [4] => 94 )
// 準備插入値 31 比比較値 75 小，比較値 75 往後複製
// Array ( [0] => 18 [1] => 53 [2] => 75 [3] => 75 [4] => 94 )
// 準備插入値 31 比比較値 53 小，比較値 53 往後複製
// Array ( [0] => 18 [1] => 53 [2] => 53 [3] => 75 [4] => 94 )
// 準備插入値 31 沒有比比較値 18 小 ，迴圈中斷。
// 比較値位置改為準備插入値 53
Array ( [0] => 18 [1] => 31 [2] => 53 [3] => 75 [4] => 94 )
```
因此最終可寫為：
```PHP
function insertion_sort($arr) {
    for($i = 1; $i < count($arr); $i++) {
        $temp = $arr[$i];
        for($j = $i - 1; $j >= 0 && $temp < $arr[$j]; $j--) { 
            $arr[$j + 1] = $arr[$j];
        }

        $arr[$j + 1] = $temp;
    }
    return $arr;
}
```

## 程式碼
<script src="https://gist.github.com/memochou1993/45541b03004c5c52cd79fb22b2e7360c.js"></script>