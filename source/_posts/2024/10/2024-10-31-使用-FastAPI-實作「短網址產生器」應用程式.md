---
title: 使用 FastAPI 實作「短網址產生器」應用程式
date: 2024-10-31 21:23:11
tags: ["Programming", "Python", "FastAPI"]
categories: ["Programming", "Python", "FastAPI"]
---

## 前言

本文為 Python 工作坊的基礎教材，以實作「短網址產生器」應用程式為例。

## 建立專案

建立專案。

```bash
mkdir shortener-python
cd shortener-python
```

## 建立虛擬環境

建立虛擬環境。

```bash
python -m venv .venv
```

啟動虛擬環境。

```bash
source .venv/bin/activate
```

將 `.venv` 資料夾排除在版本控制之外。

```bash
echo "*" > .venv/.gitignore
```

建立 `main.py` 檔。

```py
print('Hello, World!')
```

## 初始化版本控制

初始化版本控制。

```bash
git init
```

將所有修改添加到暫存區。

```bash
git add .
```

提交修改。

```bash
git commit -m "Initial commit"
```

指定遠端儲存庫位址。

```bash
git remote add origin git@github.com:memochou1993/shortener-python.git
```

推送程式碼到遠端儲存庫。

```bash
git push -u origin main
```

## 安裝 Ruff 格式化工具

新增 `requirements.txt` 檔。

```bash
touch requirements.txt
```

修改 `requirements.txt` 檔，添加 `ruff` 依賴套件。

```txt
ruff
```

安裝依賴套件。

```bash
pip install -r requirements.txt
```

新增 `ruff.toml` 檔。

```toml
line-length = 120
indent-width = 4

[format]
quote-style = "double"
```

新增 `.vscode/settings.json` 檔。

```json
{
    "editor.formatOnSave": true,
    "editor.codeActionsOnSave": {
        "source.fixAll": "explicit",
        "source.organizeImports": "explicit"
    },
    "editor.defaultFormatter": "charliermarsh.ruff"
}
```

提交修改。

```bash
git add .
git commit -m "Add ruff dependency"
```

## 安裝 FastAPI 框架

修改 `requirements.txt` 檔，添加 `fastapi[standard]` 依賴套件。

```txt
# ...
fastapi[standard]
```

安裝依賴套件。

```bash
pip install -r requirements.txt
```

修改 `main.py` 檔。

```py
from fastapi import FastAPI

app = FastAPI()


@app.get("/")
def read_root():
    return {"Hello": "World"}
```

啟動伺服器。

```bash
fastapi dev main.py
```

新增 `.gitignore` 檔，將 `__pycache__` 資料夾排除在版本控制之外。

```bash
__pycache__
```

提交修改。

```bash
git add .
git commit -m "Add fastapi dependency"
```

## 安裝 nanoid 套件

修改 `requirements.txt` 檔，添加 `nanoid` 依賴套件。

```txt
# ...
nanoid
```

安裝依賴套件。

```bash
pip install -r requirements.txt
```

修改 `main.py` 檔。

```py
from fastapi import FastAPI
from nanoid import generate

app = FastAPI()


@app.get("/")
def read_root():
    return {"code": generate(size=8)}
```

提交修改。

```bash
git add .
git commit -m "Add nanoid dependency"
```

## 實作

TODO

## 參考資料

- [FastAPI](https://fastapi.tiangolo.com/)
- [ai/nanoid](https://github.com/ai/nanoid)
- [Nano ID Collision Calculator](https://zelark.github.io/nano-id-cc/)
